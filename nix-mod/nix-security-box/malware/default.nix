# Useful tools for malware analysis

{ pkgs, lib, config, ... }:

with lib;
let cfg = config.modules.malware;

in {
    options.modules.malware = { enable = mkEnableOption "malware"; };
    config = mkIf cfg.enable {
      environment.systemPackages = with pkgs; [
        bingrep
        cutter
        flare-floss
        gdb
        ghidra-bin
        imhex
        ioc-scan
        pev
        pwndbg
        python3Packages.binwalk
        python3Packages.malduck
        python3Packages.karton-core
        python3Packages.unicorn
        python3Packages.r2pipe
        radare2
        radare2-cutter
        rizin
        stacs
        unicorn
        unicorn-emu
        xortool
        yara
        zkar
        zydis
      ];
    };
}
